#!/bin/bash

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
PROJECT_DIR="$(dirname $SCRIPT_DIR)"
MOUNT_DIR=/mnt/policy-browser
RUBY_IMG=cybera/policy-browser/ruby
PYTHON_IMG=cybera/policy-browser/python

ruby_script() {
	script_name=$1
	echo "Running $script_name"
	docker run -it --rm \
		-v $PROJECT_DIR:$MOUNT_DIR \
		$RUBY_IMG \
		bash -c "cd $MOUNT_DIR; scripts/$script_name"
}

python_script() {
	script_name=$1	
	echo "Running $script_name"
	docker run -it --rm \
		-v $PROJECT_DIR:$MOUNT_DIR \
		$PYTHON_IMG \
		bash -c "cd $MOUNT_DIR; scripts/$script_name"
}

ruby_script wrangling/make-db.rb
ruby_script wrangling/import-docs.rb
python_script wrangling/named-entities.py
python_script wrangling/filename-meta.py